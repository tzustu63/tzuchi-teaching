<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>課程計劃生成器</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- 語言切換按鈕 -->
    <div
      id="language-switcher"
      style="
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1001;
        background: white;
        padding: 10px 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        cursor: pointer;
      "
      onclick="toggleLanguage()"
    >
      <span id="current-lang-text">中文</span>
      <span id="switch-to-text"> / English</span>
    </div>

    <!-- 側邊欄 -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>📚 課程計劃生成器</h1>
        <p class="subtitle">AI 驅動的完整課程計劃工具</p>
      </div>

      <!-- 步驟列表 -->
      <nav class="steps-nav">
        <div class="step-item" data-step="history" id="nav-history">
          <span class="step-number">📚</span>
          <span class="step-label">歷史記錄</span>
        </div>
        <div class="step-item" data-step="1" id="nav-step-1">
          <span class="step-number">1</span>
          <span class="step-label">基本資訊</span>
        </div>
        <div class="step-item" data-step="2" id="nav-step-2">
          <span class="step-number">2</span>
          <span class="step-label">教學理念</span>
        </div>
        <div class="step-item" data-step="3" id="nav-step-3">
          <span class="step-number">3</span>
          <span class="step-label">學習目標</span>
        </div>
        <div class="step-item" data-step="4" id="nav-step-4">
          <span class="step-number">4</span>
          <span class="step-label">教學策略</span>
        </div>
        <div class="step-item" data-step="5" id="nav-step-5">
          <span class="step-number">5</span>
          <span class="step-label">教學流程</span>
        </div>
        <div class="step-item" data-step="6" id="nav-step-6">
          <span class="step-number">6</span>
          <span class="step-label">教學材料</span>
        </div>
        <div class="step-item" data-step="7" id="nav-step-7">
          <span class="step-number">7</span>
          <span class="step-label">製作學習單</span>
        </div>
      </nav>

      <!-- AI 模型選擇 -->
      <div class="ai-model-selector">
        <h3
          style="
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            padding: 0 20px;
          "
        >
          🤖 AI 模型
        </h3>
        <select id="sidebar-ai-model-select" class="sidebar-select">
          <option value="openai">OpenAI</option>
          <option value="claude">Claude</option>
        </select>

        <h3
          style="
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            margin-top: 15px;
            padding: 0 20px;
          "
        >
          📡 子模型
        </h3>
        <select id="sidebar-ai-submodel-select" class="sidebar-select">
          <!-- OpenAI 模型 -->
          <option value="gpt-4o" data-provider="openai">GPT-4o (最新)</option>
          <option value="gpt-4o-mini" data-provider="openai">
            GPT-4o Mini (快速經濟)
          </option>
          <option value="gpt-4-turbo" data-provider="openai">
            GPT-4 Turbo
          </option>
          <option value="gpt-4" data-provider="openai">GPT-4</option>
          <option value="gpt-3.5-turbo" data-provider="openai">
            GPT-3.5 Turbo
          </option>

          <!-- Claude 模型 -->
          <option
            value="claude-sonnet-4-5-20250929"
            data-provider="claude"
            style="display: none"
          >
            Claude Sonnet 4.5 (最新)
          </option>
          <option
            value="claude-3-5-sonnet-20241022"
            data-provider="claude"
            style="display: none"
          >
            Claude 3.5 Sonnet
          </option>
          <option
            value="claude-3-5-haiku-20241022"
            data-provider="claude"
            style="display: none"
          >
            Claude 3.5 Haiku (快速)
          </option>
          <option
            value="claude-3-opus-20240229"
            data-provider="claude"
            style="display: none"
          >
            Claude 3 Opus
          </option>
          <option
            value="claude-3-sonnet-20240229"
            data-provider="claude"
            style="display: none"
          >
            Claude 3 Sonnet
          </option>
        </select>
      </div>

      <!-- 設置按鈕 -->
      <div class="sidebar-footer">
        <button id="toggle-prompt-editor" class="btn-settings">
          📝 Prompt 編輯
        </button>
      </div>
    </aside>

    <!-- 主內容區 -->
    <div class="main-content">
      <!-- 語言切換按鈕 -->
      <div
        id="language-switcher"
        style="
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 1001;
          background: white;
          padding: 10px 15px;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          cursor: pointer;
        "
        onclick="toggleLanguage()"
      >
        <span id="current-lang-text">中文</span>
        <span id="switch-to-text"> / English</span>
      </div>

      <div class="container">
        <!-- 歷史記錄頁面 -->
        <section id="history-page" class="card" style="display: none">
          <h2>📚 課程計劃歷史記錄</h2>
          <div id="history-list" class="history-list"></div>
        </section>

        <!-- 課程計劃詳情頁面 -->
        <section id="plan-detail-page" class="card" style="display: none">
          <h2 id="detail-title">課程計劃詳情</h2>
          <button
            id="back-to-history"
            class="btn btn-secondary"
            onclick="goBackToHistory()"
          >
            ← 返回歷史記錄
          </button>

          <div id="detail-content" class="plan-detail-content"></div>
        </section>

        <!-- 歡迎資訊 -->
        <section id="api-key-section" class="card settings-card">
          <h2>👋 歡迎使用課程計劃生成器</h2>
          <p
            style="
              color: rgba(255, 255, 255, 0.9);
              margin-bottom: 20px;
              font-size: 1.1em;
              line-height: 1.8;
            "
          >
            請在左側選擇 AI 模型，然後開始創建您的課程計劃！
          </p>
          <div
            style="
              background: rgba(255, 255, 255, 0.1);
              padding: 20px;
              border-radius: 8px;
              margin: 20px 0;
            "
          >
            <h3 style="color: white; margin-bottom: 15px">✨ 功能特色</h3>
            <ul style="color: rgba(255, 255, 255, 0.9); line-height: 2">
              <li>🚀 使用最新的 AI 模型（GPT-4o / Claude Sonnet 4.5）</li>
              <li>📝 六步驟生成完整課程計劃</li>
              <li>🎨 美觀的側邊欄導航</li>
              <li>🔧 可自訂 Prompt 模板</li>
              <li>💾 自動儲存進度</li>
            </ul>
          </div>
          <button
            id="start-using"
            class="btn-primary"
            style="width: 100%; padding: 15px; font-size: 18px"
          >
            ✅ 開始使用
          </button>
          <div id="api-key-status"></div>
        </section>

        <!-- 主要工作流程 -->
        <div id="workflow-container" style="display: none">
          <!-- Step 1: 基本資訊輸入 -->
          <section id="step1" class="card step">
            <h2>步驟 1: 基本課程資訊</h2>
            <form id="basic-info-form">
              <div class="form-group">
                <label for="title">課程標題 *</label>
                <input type="text" id="title" required />
              </div>

              <div class="form-group">
                <label for="grade">年級 *</label>
                <select id="grade" required>
                  <option value="">請選擇</option>
                  <option value="一年級">一年級</option>
                  <option value="二年級">二年級</option>
                  <option value="三年級">三年級</option>
                  <option value="四年級">四年級</option>
                  <option value="五年級">五年級</option>
                  <option value="六年級">六年級</option>
                </select>
              </div>

              <div class="form-group">
                <label for="duration">課程時長（分鐘）*</label>
                <input type="number" id="duration" min="1" required />
              </div>

              <div class="form-group">
                <label for="student-count">學生人數 *</label>
                <input type="number" id="student-count" min="1" required />
              </div>

              <div class="form-group">
                <label for="equipment">教室設備</label>
                <input
                  type="text"
                  id="equipment"
                  placeholder="例如: 投影機、電腦、白板"
                />
              </div>

              <div class="form-group">
                <label for="upload-file">教案內容（選填）</label>
                <input type="file" id="upload-file" accept=".docx,.pdf,.txt" />
                <small>支援格式: .docx, .pdf, .txt（最大 10MB）</small>
              </div>

              <button type="submit" class="btn btn-primary">
                下一步：生成教學理念
              </button>
            </form>
          </section>

          <!-- Step 2: 教學理念 -->
          <section id="step2" class="card step" style="display: none">
            <h2>步驟 2: 教學理念</h2>
            <div id="rationale-content" class="generated-content"></div>
            <div class="step-actions">
              <button id="edit-rationale" class="btn btn-secondary">
                編輯
              </button>
              <button id="regenerate-rationale" class="btn btn-secondary">
                重新生成
              </button>
              <button id="confirm-rationale" class="btn btn-primary">
                下一步：生成學習目標
              </button>
            </div>
          </section>

          <!-- Step 3: 學習目標 -->
          <section id="step3" class="card step" style="display: none">
            <h2>步驟 3: 學習目標</h2>
            <div id="objectives-content" class="generated-content"></div>
            <div class="step-actions">
              <button id="edit-objectives" class="btn btn-secondary">
                編輯
              </button>
              <button id="regenerate-objectives" class="btn btn-secondary">
                重新生成
              </button>
              <button id="confirm-objectives" class="btn btn-primary">
                下一步：生成教學策略
              </button>
            </div>
          </section>

          <!-- Step 4: 教學策略 -->
          <section id="step4" class="card step" style="display: none">
            <h2>步驟 4: 教學策略</h2>
            <div id="strategies-content" class="generated-content"></div>
            <div class="step-actions">
              <button id="edit-strategies" class="btn btn-secondary">
                編輯
              </button>
              <button id="regenerate-strategies" class="btn btn-secondary">
                重新生成
              </button>
              <button id="confirm-strategies" class="btn btn-primary">
                下一步：生成教學流程
              </button>
            </div>
          </section>

          <!-- Step 5: 教學流程 -->
          <section id="step5" class="card step" style="display: none">
            <h2>步驟 5: 教學流程</h2>
            <div id="flow-content" class="generated-content"></div>
            <div class="step-actions">
              <button id="edit-flow" class="btn btn-secondary">編輯</button>
              <button id="regenerate-flow" class="btn btn-secondary">
                重新生成
              </button>
              <button id="toggle-gamma-settings" class="btn btn-info">
                ⚙️ Gamma 設定
              </button>
              <button id="generate-materials" class="btn btn-primary">
                下一步：製作學習單
              </button>
            </div>

            <!-- Gamma 設定面板 -->
            <div
              id="gamma-settings-panel"
              class="gamma-settings-panel"
              style="display: none"
            >
              <h3 style="margin-top: 20px; margin-bottom: 15px; color: #333">
                📊 Gamma PPT 生成設定
              </h3>

              <div
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px"
              >
                <!-- 基本設定 -->
                <div class="setting-group">
                  <label for="gamma-language">語言</label>
                  <select id="gamma-language" class="modern-select">
                    <option value="zh-tw">繁體中文</option>
                    <option value="zh-cn">簡體中文</option>
                    <option value="en">英文</option>
                    <option value="ja">日文</option>
                    <option value="ko">韓文</option>
                  </select>
                </div>

                <div class="setting-group">
                  <label for="gamma-num-cards">卡牌數量</label>
                  <input
                    type="number"
                    id="gamma-num-cards"
                    value="10"
                    min="1"
                    max="60"
                    class="modern-input"
                  />
                </div>

                <!-- 文字設定 -->
                <div class="setting-group">
                  <label for="gamma-text-amount">文字量</label>
                  <select id="gamma-text-amount" class="modern-select">
                    <option value="brief">簡短</option>
                    <option value="medium" selected>中等</option>
                    <option value="detailed">詳細</option>
                    <option value="extensive">非常詳細</option>
                  </select>
                </div>

                <div class="setting-group">
                  <label for="gamma-tone">語調</label>
                  <input
                    type="text"
                    id="gamma-tone"
                    value="專業, 清晰"
                    placeholder="例如: 專業, 清晰"
                    class="modern-input"
                  />
                </div>

                <!-- 圖片設定 -->
                <div class="setting-group">
                  <label for="gamma-image-model">圖片模型</label>
                  <select id="gamma-image-model" class="modern-select">
                    <option value="flux-1-pro" selected>Flux 1 Pro</option>
                    <option value="flux-1-quick">Flux 1 Quick</option>
                    <option value="flux-1-ultra">Flux 1 Ultra</option>
                    <option value="dall-e-3">DALL-E 3</option>
                    <option value="imagen-3-pro">Imagen 3 Pro</option>
                    <option value="imagen-4-pro">Imagen 4 Pro</option>
                  </select>
                </div>

                <div class="setting-group">
                  <label for="gamma-image-style">圖片風格</label>
                  <input
                    type="text"
                    id="gamma-image-style"
                    value="真實攝影"
                    placeholder="例如: 真實攝影, 插畫風格"
                    class="modern-input"
                  />
                </div>

                <!-- 觀眾設定 -->
                <div class="setting-group" style="grid-column: 1 / -1">
                  <label for="gamma-audience">觀眾/目標群體</label>
                  <input
                    type="text"
                    id="gamma-audience"
                    value="國小學生"
                    placeholder="例如: 國小學生, 專業人士"
                    class="modern-input"
                  />
                </div>
              </div>

              <div
                style="
                  margin-top: 20px;
                  padding: 15px;
                  background: #e3f2fd;
                  border-radius: 8px;
                  font-size: 0.9em;
                  border: 1px solid #90caf9;
                "
              >
                <strong style="color: #1976d2">💡 提示：</strong>
                <ul style="margin: 10px 0 0 20px; color: #424242">
                  <li>卡牌數量建議：10-15 張較適合教學簡報</li>
                  <li>文字量選擇「詳細」或「非常詳細」會有更豐富的內容</li>
                  <li>
                    圖片風格可輸入多個關鍵字，例如：「真實攝影, 明亮, 專業」
                  </li>
                </ul>
              </div>
            </div>
          </section>

          <!-- Step 6: 教學材料 -->
          <section id="step6" class="card step" style="display: none">
            <h2>步驟 6: 教學材料</h2>
            <div id="materials-content"></div>
            <div class="step-actions">
              <button id="generate-worksheets" class="btn btn-primary">
                下一步：製作學習單
              </button>
            </div>
          </section>

          <!-- Step 7: 製作學習單 -->
          <section id="step7" class="card step" style="display: none">
            <h2>步驟 7: 製作學習單</h2>
            <div id="worksheet-content" class="generated-content"></div>
            <div class="step-actions">
              <button id="edit-worksheet" class="btn btn-secondary">
                編輯
              </button>
              <button id="regenerate-worksheet" class="btn btn-secondary">
                重新生成
              </button>
              <button id="download-worksheet" class="btn btn-success">
                下載學習單
              </button>
            </div>
          </section>

          <!-- Prompt 編輯器 -->
          <section id="prompt-editor" class="card" style="display: none">
            <h2>📝 Prompt 編輯器</h2>
            <div class="prompt-editor-controls">
              <label for="prompt-step-select">選擇要編輯的步驟：</label>
              <select id="prompt-step-select" class="modern-select">
                <option value="1">步驟 1: 教學理念</option>
                <option value="2">步驟 2: 學習目標</option>
                <option value="3">步驟 3: 教學策略</option>
                <option value="4">步驟 4: 教學流程</option>
                <option value="5">步驟 5: PPT 生成</option>
                <option value="6">步驟 6: 學習單</option>
              </select>
            </div>

            <div id="prompt-editor-content" class="prompt-editor-content">
              <div class="prompt-info">
                <h3 id="prompt-name"></h3>
                <p>
                  <strong>可用變數：</strong><span id="prompt-variables"></span>
                </p>
              </div>

              <div class="form-group">
                <label for="prompt-content">Prompt 內容：</label>
                <textarea
                  id="prompt-content"
                  rows="15"
                  class="prompt-textarea"
                ></textarea>
              </div>

              <div class="prompt-actions">
                <button id="save-prompt" class="btn btn-primary">
                  💾 儲存 Prompt
                </button>
                <button id="reset-prompt" class="btn btn-secondary">
                  🔄 重置為預設
                </button>
                <button id="close-prompt-editor" class="btn btn-secondary">
                  ❌ 關閉
                </button>
              </div>

              <div id="prompt-status" class="prompt-status"></div>
            </div>
          </section>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
